import{B as D,r as v,C as E,c as O,M as g,D as y,L as h,$ as b,E as x,z as w,G as M,H as L,d as R,e as f,f as p,g as e,F as S,l as V,t as _,p as N,h as $,w as q,m as B,i as d,I as F,j as k,n as T,J as U,s as j,K as I,o as z,N as H,_ as G,q as P,k as J}from"./index.95ddf099.js";import{_ as K,s as Q}from"./Alert.5be4f3b0.js";const A=D("order",()=>{const i=v(5),r=v([]),t=E({course:"Todos",status:["Aguardando"],name:""}),l=v(null),u=O(()=>l.value!=null&&r.value.length>i.value-1),c=async()=>{let s;t.course!="Todos"?s=g(x(w,"orders"),b("course","==",t.course),b("status","in",t.status),h("name"),y(i.value)):s=g(x(w,"orders"),b("status","in",t.status),h("name"),y(i.value)),await M(s).then(o=>{l.value=o.docs[o.docs.length-1],r.value=o.docs.map(a=>({id:a.id,...a.data()}))})};return{orders:r,filters:t,fetch:c,findByName:async()=>{h.value=[],l.value=null;let s;t.name?(s=g(x(w,"orders"),b("name",">=",t.name&&t.name.toUpperCase()),b("name","<=",t.name&&t.name.toUpperCase()+"\uF8FF"),h("name"),y(i.value)),await M(s).then(o=>{r.value=o.docs.map(a=>({id:a.id,...a.data()}))})):c()},btnLoadMoreVisible:u,loadMore:async()=>{let s;t.course!="Todos"?s=g(x(w,"orders"),b("course","==",t.course),b("status","in",t.status),h("name"),L(l.value),y(i.value)):s=g(x(w,"orders"),b("status","in",t.status),h("name"),L(l.value),y(i.value)),await M(s).then(o=>{l.value=o.docs[o.docs.length-1],o.forEach(a=>{r.value.push({id:a.id,...a.data()})})})}}}),W={class:"overflow-x-auto w-full"},X={class:"table w-full"},Y=e("thead",null,[e("tr",null,[e("th",null,"Aluno"),e("th",null,"DRE"),e("th",null,"Curso"),e("th",null,"Status"),e("th",null,"Efetivado/SIGA"),e("th")])],-1),Z={class:"font-bold"},ee={class:"text-sm opacity-50"},te=e("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-5 h-5"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L10.582 16.07a4.5 4.5 0 01-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 011.13-1.897l8.932-8.931zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0115.75 21H5.25A2.25 2.25 0 013 18.75V8.25A2.25 2.25 0 015.25 6H10"})],-1),se={key:0},oe=e("td",{colspan:"6",class:"text-center"},"Nenhum registro encontrado",-1),ne=[oe],ae={class:"flex justify-center py-4"},le={__name:"Table",props:{orders:Array},setup(i){const r=A(),t=l=>l==="Aguardando"?"badge-warning":l==="Deferido"?"badge-success":l==="Indeferido"?"badge-error":"badge-info";return(l,u)=>{const c=R("RouterLink");return f(),p("div",null,[e("div",W,[e("table",X,[Y,e("tbody",null,[(f(!0),p(S,null,V(i.orders,n=>(f(),p("tr",{key:n.id},[e("td",null,[e("div",null,[e("div",Z,_(n.name),1),e("div",ee,_(n.email),1)])]),e("td",null,_(n.register),1),e("td",null,_(n.course),1),e("th",null,[e("div",{class:N(["badge badge-outline",t(n.status)])},_(n.status),3)]),e("td",null,[e("span",{class:N(n.provided?"text-success":"text-error")},_(n.provided?"Sim":"N\xE3o"),3)]),e("td",null,[$(c,{to:{name:"manager",params:{id:n.id}},class:"btn btn-square btn-sm"},{default:q(()=>[te]),_:2},1032,["to"])])]))),128)),i.orders.length===0?(f(),p("tr",se,ne)):B("",!0)])])]),e("div",ae,[d(r).btnLoadMoreVisible?(f(),p("button",{key:0,type:"button",class:"btn btn-primary btn-sm",onClick:u[0]||(u[0]=(...n)=>d(r).loadMore&&d(r).loadMore(...n))}," Exibir mais... ")):B("",!0)])])}}},re={class:"modal"},ie={class:"modal-box relative"},ue=e("h3",{class:"text-lg font-bold mb-6"},"Filtrar Solicita\xE7\xF5es",-1),de={class:"p-4 mb-4 border border-base-200 rounded-md"},ce=e("legend",{class:"text-content text-sm font-semibold"},"Curso",-1),me={class:"label cursor-pointer"},_e={class:"label-text"},fe=["value"],pe={class:"p-4 mb-4 border border-base-200 rounded-md"},be=e("legend",{class:"text-content text-sm font-semibold"},"Status",-1),ve={class:"label cursor-pointer"},he={class:"label-text"},ge=["value"],ye={class:"form-control mt-6"},xe={__name:"FilterModal",props:{isOpen:Boolean},emits:["close"],setup(i,{emit:r}){const t=v(null),l=v(!1),u=async()=>{if(t.value=null,m.value.status.length==0){t.value="Selecione pelo menos um status.";return}l.value=!0;try{await n.fetch(),c()}catch(s){console.log(s),s.value="Ocorreu um problema. Tente novamente."}finally{l.value=!1}},c=()=>{r("close")},n=A(),{filters:m}=F(n);return(s,o)=>(f(),p("div",null,[k(e("input",{type:"checkbox",class:"modal-toggle","onUpdate:modelValue":o[0]||(o[0]=a=>U(isOpen)?isOpen.value=a:null)},null,512),[[T,i.isOpen]]),e("div",re,[e("div",ie,[e("button",{onClick:c,class:"btn btn-sm btn-circle absolute right-2 top-2"}," \u2715 "),$(K,{show:t.value!=null,type:"error",class:"mt-6 mb-2"},{default:q(()=>[j(_(t.value),1)]),_:1},8,["show"]),ue,e("fieldset",de,[ce,(f(),p(S,null,V(["Todos","Integral","Noturno"],a=>e("div",{class:"form-control",key:a},[e("label",me,[e("span",_e,_(a),1),k(e("input",{type:"radio",name:"radio-6",class:"radio","onUpdate:modelValue":o[1]||(o[1]=C=>d(m).course=C),value:a},null,8,fe),[[I,d(m).course]])])])),64))]),e("fieldset",pe,[be,(f(),p(S,null,V(["Aguardando","Deferido","Indeferido"],a=>e("div",{class:"form-control",key:a},[e("label",ve,[e("span",he,_(a),1),k(e("input",{type:"checkbox",class:"checkbox","onUpdate:modelValue":o[2]||(o[2]=C=>d(m).status=C),value:a},null,8,ge),[[T,d(m).status]])])])),64))]),e("div",ye,[e("button",{onClick:u,class:N(["btn btn-primary",l.value&&"loading"])}," Filtrar ",2)])])])]))}},we={class:"container mx-auto px-4 pb-12"},$e=e("h1",{class:"text-3xl font-bold my-8"},"Solicita\xE7\xF5es",-1),ke={class:"flex items-center sm:justify-between mb-4"},Ce=["onSubmit"],Me={class:"form-control w-full"},Se={class:"flex items-center space-x-2"},Ve=e("button",{type:"submit",class:"btn btn-primary btn-sm"}," Pesquisar ",-1),Le={__name:"AdminView",setup(i){const r=A(),{filters:t,orders:l}=F(r),u=v(!1),c=v(null);z(async()=>{await r.fetch(),c.value=await Q.find()});const n=async()=>{await r.findByName()};return H(()=>t.value.name,m=>{m===""&&r.fetch()}),(m,s)=>(f(),p("div",we,[$(G,{onSearch:s[0]||(s[0]=o=>u.value=!0)}),$e,$(xe,{onClose:s[1]||(s[1]=o=>u.value=!1),"is-open":u.value},null,8,["is-open"]),e("div",ke,[e("form",{onSubmit:P(n,["prevent"])},[e("div",Me,[e("div",Se,[k(e("input",{type:"search",placeholder:"Pesquisar por nome",class:"input input-bordered input-sm","onUpdate:modelValue":s[2]||(s[2]=o=>d(t).name=o)},null,512),[[J,d(t).name]]),Ve])])],40,Ce),e("button",{type:"button",class:"btn btn-primary btn-sm",onClick:s[3]||(s[3]=o=>u.value=!0)}," Filtrar ")]),$(le,{orders:d(l)},null,8,["orders"])]))}};export{Le as default};
